<view class="analysis-container">
  <!-- 自定义导航栏 -->
  <view class="custom-nav">
    <view class="status-bar"></view>
    <view class="nav-content">
      <view class="nav-back" bindtap="navigateBack">
        <text class="back-icon">←</text>
      </view>
      <view class="nav-title">AI解析</view>
      <view class="nav-placeholder"></view>
    </view>
  </view>

  <!-- 答案展示卡片 -->
  <view class="answer-card">
    <text class="answer-text">「{{answer}}」</text>
    <view class="source-tag" wx:if="{{!isLoading}}">
      <text class="{{analysisSource === 'ai' ? 'ai-tag' : analysisSource === 'local' ? 'local-tag' : 'default-tag'}}">
        {{analysisSource === 'ai' ? 'AI分析' : analysisSource === 'local' ? '预设解析' : '默认解析'}}
      </text>
    </view>
  </view>

  <!-- 加载中状态 -->
  <view class="loading" wx:if="{{isLoading}}">
    <image class="loading-icon" src="{{icons.loading}}" mode="aspectFit"/>
    <text class="loading-text">正在生成分析...</text>
  </view>

  <!-- 分析内容 -->
  <view class="analysis-content" wx:else>
    <view class="section">
      <view class="section-title">核心观点</view>
      <view class="section-content">{{analysis.core}}</view>
    </view>

    <view class="section">
      <view class="section-title" bindtap="toggleSection" data-section="manifestation">
        <text>表现分析</text>
        <image class="icon" src="{{icons.arrow}}" mode="aspectFit" 
               style="transform: rotate({{expandStatus.manifestation ? 180 : 0}}deg)"/>
      </view>
      <view class="section-content {{expandStatus.manifestation ? '' : 'collapsed'}}">
        {{analysis.manifestation}}
      </view>
    </view>

    <view class="section">
      <view class="section-title" bindtap="toggleSection" data-section="solution">
        <text>解决方案</text>
        <image class="icon" src="{{icons.arrow}}" mode="aspectFit"
               style="transform: rotate({{expandStatus.solution ? 180 : 0}}deg)"/>
      </view>
      <view class="section-content {{expandStatus.solution ? '' : 'collapsed'}}">
        {{analysis.solution}}
      </view>
    </view>

    <view class="section">
      <view class="section-title">温馨提示</view>
      <view class="section-content">{{analysis.tips}}</view>
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="footer">
    <button class="share-btn" open-type="share">分享答案</button>
    <button class="back-btn" bindtap="navigateBack">返回</button>
  </view>
</view> 